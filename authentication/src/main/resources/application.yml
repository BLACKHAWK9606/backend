spring:
  application:
    name: authentication
  config:
    import: optional:configserver:http://localhost:8888
  data:
    ldap:
      repositories:
        enabled: false
  cloud:
    inetutils:
      preferred-networks:
        - 127.0.0
      default-hostname: localhost
      default-ip-address: 127.0.0.1
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5432/bancassurance_auth
    username: postgres
    password: Jayjay_1
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    open-in-view: false
    properties:
      hibernate:
        format_sql: true

server:
  port: 8090

eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka
    fetch-registry: true
    register-with-eureka: true
  instance:
    prefer-ip-address: true
    ip-address: 127.0.0.1
    hostname: localhost
    lease-renewal-interval-in-seconds: 10
    lease-expiration-duration-in-seconds: 30

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

logging:
  level:
    com.bancassurance.authentication: DEBUG
    org.springframework.security: DEBUG
    org.springframework.ldap: DEBUG
    javax.naming: DEBUG
    org.hibernate.engine.transaction.jta.platform: ERROR
    org.hibernate.SQL: DEBUG
    org.springframework.orm.jpa: DEBUG

# JWT Configuration
app:
  jwt:
    secret: your_secret_key_here_should_be_at_least_32_characters_long
    access-token-expiration: 900000    # 15 minutes
    refresh-token-expiration: 7200000  # 2 hours

# LDAP Configuration for Active Directory
ldap:
  url: ldap://172.16.0.13:389
  base: DC=ad,DC=emtechhouse,DC=co,DC=ke
  username: bancassurance-svc@ad.emtechhouse.co.ke
  password: BancaService123!
  userSearchBase: OU=Bancassurance
  userSearchFilter: (|(userPrincipalName={0})(sAMAccountName={0}))
  groupSearchBase: OU=Bancassurance
  groupRoleAttribute: cn
  # Dynamic AD Group to Database Role Mapping
  groupRoleMapping:
    "Bancassurance-SUPERUSER": "SUPERUSER"
    "Bancassurance-POLICY_MANAGER": "POLICY_MANAGER"
    "Bancassurance-POLICY_OFFICER": "POLICY_OFFICER"
    "Bancassurance-VIEWER": "VIEWER"
    "Bancassurance-CLAIMS_OFFICER": "CLAIMS_OFFICER"
  defaultRole: "VIEWER"  # Fallback role for unmapped groups

# Swagger Configuration
springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operationsSorter: method

# EmTech SMS Configuration
emtech:
  sms:
    api-url: https://bulksms.emtechhouse.co.ke/sms/v3/sendsms
    api-key: ${EMTECH_SMS_API_KEY:6IGMsoav9W5q2mAiQP0f1NkKyxnFcC3HX78TpSlUg4OtVbBueLdjDJwEYzZRrh}
    sender-id: Tilil
    service-id: 0

# OTP Configuration
otp:
  length: 6
  expiry-minutes:
    login: 5
    phone-verification: 10
    password-reset: 15
  max-attempts: 3
  cleanup-interval-hours: 24
  # Development mode - bypass SMS sending
  development-mode: true



